<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Transformación Lumínica</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <style>
      /* Reset y estilos base */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        user-select: text;
      }

      body {
        font-family: "Arial", sans-serif;
        background-color: #000;
        color: #fff;
        overflow: hidden;
        height: 100vh;
        width: 100vw;
      }

      /* Capas principales */
      #transition {
        /* position: fixed; */
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #000;
        z-index: 100;
        opacity: 1;
      }

      #experience {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 10;
      }

      #final-content {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        opacity: 0;
        z-index: 5;
        padding: 2rem;
        text-align: center;
      }

      /* Efecto de fuego en bordes */
      .fire-border {
        position: absolute;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1;
      }

      .fire-particle {
        position: absolute;
        border-radius: 50%;
        filter: blur(8px);
        opacity: 0;
        will-change: transform, opacity;
        mix-blend-mode: screen;
      }

      /* Efecto de iluminación (onda de luz) */
      .light-wave {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle, rgba(255, 200, 100, 0.9) 0%, rgba(255, 150, 50, 0) 70%);
        opacity: 0;
        filter: blur(30px);
        z-index: 25;
        pointer-events: none;
        transform: scale(0.1);
        transform-origin: center;
      }

      /* Textos */
      .message {
        position: relative;
        text-align: center;
        z-index: 15;
        max-width: 80%;
        pointer-events: none;
      }

      .message h1 {
        font-size: 3.5rem;
        font-weight: 300;
        letter-spacing: 0.3rem;
        text-transform: uppercase;
        margin-bottom: 1.5rem;
        opacity: 0;
        transform: translateY(50px);
        text-shadow: 0 0 15px rgba(255, 100, 0, 0.7);
      }

      .message p {
        font-size: 1.2rem;
        line-height: 1.6;
        opacity: 0;
        transform: translateY(30px);
        max-width: 700px;
        margin: 0 auto 3rem;
      }

      /* Vela y elementos interactivos */
      #candle-interactive {
        position: relative;
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 1rem 0;
        pointer-events: auto;
        z-index: 15;
      }

      #candle-container {
        position: relative;
        width: 70px;
        height: 180px;
        opacity: 0;
        transform: translateY(80px);
        cursor: pointer;
        transition: transform 0.3s ease;
      }

      #candle-container:hover {
        transform: translateY(80px) scale(1.05);
      }

      .wax {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 140px;
        background: linear-gradient(to top, #e6d5b8, #f8f0e5);
        border-radius: 6px;
        box-shadow: inset 0 -8px 15px rgba(0, 0, 0, 0.2);
      }

      .wick {
        position: absolute;
        top: 0;
        left: 50%;
        width: 3px;
        height: 15px;
        background: #2c1a0a;
        transform: translateX(-50%) translateY(-1px);
        transition: all 0.5s ease;
      }

      .flame {
        position: absolute;
        top: -25px;
        left: 33%; /* Centrado relativo al contenedor */
        width: 20px;
        height: 50px;
        background: linear-gradient(to top, #ff5500, #ffff00);
        border-radius: 50% 50% 20% 20%;
        transform: translateX(-50%) translateY(-10px); /* Centrado exacto */
        filter: blur(6px) brightness(1.2);
        opacity: 0;
        box-shadow: 0 0 25px 10px rgba(255, 100, 0, 0.3), 0 0 40px 20px rgba(255, 200, 0, 0.2);
        transform-origin: 50% 100%;
        will-change: transform, opacity, filter;
      }

      .wick-glow {
        position: absolute;
        top: -6px;
        left: 35%;
        width: 6px;
        height: 6px;
        background: #ff5500;
        border-radius: 50%;
        transform: translateX(-50%);
        filter: blur(3px);
        opacity: 0;
        z-index: 1;
      }

      .candle-text {
        position: absolute;
        top: -50px;
        left: 0;
        width: 100%;
        text-align: center;
        font-size: 1rem;
        color: #fff;
        text-shadow: 0 0 6px rgba(255, 200, 0, 0.7);
        opacity: 0;
        pointer-events: none;
      }

      .hint {
        margin-top: 1.5rem;
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.6);
        opacity: 0;
        transform: translateY(10px);
        transition: all 0.5s ease;
        pointer-events: none;
      }

      #candle-container:hover ~ .hint {
        opacity: 1;
        transform: translateY(0);
      }

      /* Efectos de chispas */
      .spark {
        position: absolute;
        background: radial-gradient(circle, #ffd700 0%, transparent 70%);
        border-radius: 50%;
        pointer-events: none;
        filter: blur(1.5px);
        z-index: 20;
      }

      /* Contenido final */
      #final-content h2 {
        font-size: 2.5rem;
        margin-bottom: 1.5rem;
        color: #fff;
        text-shadow: 0 0 10px rgba(255, 100, 0, 0.5);
      }

      #final-content p {
        font-size: 1.1rem;
        max-width: 600px;
        line-height: 1.6;
        color: #ccc;
      }
    </style>
  </head>
  <body>
    <!-- Capa de transición inicial -->
    <div id="transition"></div>

    <!-- Experiencia principal -->
    <div id="experience">
      <!-- Efecto de fuego en bordes -->
      <div class="fire-border" id="fire-border"></div>

      <!-- Efecto de onda de luz -->
      <div class="light-wave" id="light-wave"></div>

      <!-- Mensaje central -->
      <div class="message">
        <h1>El momento es ahora</h1>
        <p>Todo lo que has vivido te ha preparado para este instante de transformación</p>

        <!-- Contenedor interactivo para la vela -->
        <div id="candle-interactive">
          <!-- Vela central -->
          <div id="candle-container">
            <div class="candle-text">Toca la vela</div>
            <div class="wax"></div>
            <div class="wick"></div>
            <div class="wick-glow"></div>
            <div class="flame"></div>
          </div>
          <div class="hint">Haz clic para encender</div>
        </div>
      </div>
    </div>

    <!-- Contenido final -->
    <div id="final-content">
      <h2>Tu viaje comienza</h2>
      <p>Este es el punto de inflexión donde todo cambia. La llama que has encendido iluminará el camino hacia tu nueva realidad.</p>
    </div>

    <script>
      // Configuración
      const config = {
        fireParticles: 100,
        sparks: 50,
        sequenceDelay: 500,
        igniteDelay: 1500,
        lightWaveDuration: 1200,
      };

      // Inicialización
      document.addEventListener("DOMContentLoaded", function () {
        // Ocultar transición
        anime({
          targets: "#transition",
          opacity: 0,
          duration: 1500,
          easing: "easeOutQuad",
          complete: startExperience,
        });

        // Crear partículas de fuego en bordes
        createFireBorder();

        // Configurar evento de clic en la vela
        document.getElementById("candle-container").addEventListener("click", igniteTransformation);
      });

      // Crear efecto de fuego en bordes
      function createFireBorder() {
        const border = document.getElementById("fire-border");
        const width = window.innerWidth;
        const height = window.innerHeight;

        for (let i = 0; i < config.fireParticles; i++) {
          const particle = document.createElement("div");
          particle.className = "fire-particle";

          // Posicionar en los bordes
          let posX, posY;
          const side = Math.floor(Math.random() * 4);

          switch (side) {
            case 0:
              posX = Math.random() * width;
              posY = 0;
              break;
            case 1:
              posX = width;
              posY = Math.random() * height;
              break;
            case 2:
              posX = Math.random() * width;
              posY = height;
              break;
            case 3:
              posX = 0;
              posY = Math.random() * height;
              break;
          }

          particle.style.left = `${posX}px`;
          particle.style.top = `${posY}px`;

          // Tamaño y color
          const size = Math.random() * 60 + 30;
          const hue = Math.random() * 30 + 15;
          particle.style.width = `${size}px`;
          particle.style.height = `${size}px`;
          particle.style.background = `radial-gradient(circle, hsl(${hue}, 100%, 50%) 0%, transparent 70%`;

          border.appendChild(particle);

          // Animación
          animateFireParticle(particle);
        }
      }

      function animateFireParticle(particle) {
        const duration = Math.random() * 6000 + 6000;
        const delay = Math.random() * 3000;

        anime({
          targets: particle,
          translateX: () => anime.random(-100, 100),
          translateY: () => anime.random(-100, 100),
          opacity: [
            { value: [0, 0.5], duration: 2000, easing: "easeOutQuad" },
            { value: [0.5, 0], duration: 4000, delay: 2000, easing: "easeInQuad" },
          ],
          scale: [
            { value: [0.3, 0.9], duration: 3000, easing: "easeOutSine" },
            { value: [0.9, 0.2], duration: 3000, easing: "easeInSine" },
          ],
          complete: () => {
            const width = window.innerWidth;
            const height = window.innerHeight;
            let posX, posY;
            const side = Math.floor(Math.random() * 4);

            switch (side) {
              case 0:
                posX = Math.random() * width;
                posY = 0;
                break;
              case 1:
                posX = width;
                posY = Math.random() * height;
                break;
              case 2:
                posX = Math.random() * width;
                posY = height;
                break;
              case 3:
                posX = 0;
                posY = Math.random() * height;
                break;
            }

            particle.style.left = `${posX}px`;
            particle.style.top = `${posY}px`;
            animateFireParticle(particle);
          },
          delay: delay,
        });
      }

      // Iniciar experiencia
      function startExperience() {
        // Animación de texto
        anime({
          targets: ".message h1",
          opacity: [0, 1],
          translateY: ["50px", "0px"],
          duration: 1500,
          easing: "easeOutQuint",
          delay: config.sequenceDelay,
        });

        anime({
          targets: ".message p",
          opacity: [0, 1],
          translateY: ["30px", "0px"],
          duration: 1200,
          easing: "easeOutQuint",
          delay: config.sequenceDelay + 500,
        });

        // Mostrar vela
        anime({
          targets: "#candle-container",
          opacity: [0, 1],
          translateY: ["80px", "0px"],
          duration: 1200,
          easing: "easeOutBack",
          delay: config.sequenceDelay + 1000,
          complete: function () {
            // Mostrar texto de la vela
            anime({
              targets: ".candle-text",
              opacity: [0, 1],
              duration: 800,
              easing: "easeOutQuad",
            });

            // Mostrar mensaje de interacción
            anime({
              targets: ".hint",
              opacity: [0, 0.6],
              translateY: ["10px", "0px"],
              duration: 800,
              delay: 500,
              easing: "easeOutQuad",
            });
          },
        });
      }

      // Encender la transformación
      function igniteTransformation() {
        // Desactivar interacción
        document.getElementById("candle-container").style.pointerEvents = "none";
        document.querySelector(".hint").style.opacity = "0";

        // 1. Calentamiento de la mecha
        anime({
          targets: ".wick",
          backgroundColor: ["#2c1a0a", "#ff5500"],
          height: ["15px", "12px"],
          duration: 400,
          easing: "easeOutQuad",
        });

        // 2. Brillar la punta de la mecha
        anime({
          targets: ".wick-glow",
          opacity: [0, 1],
          scale: [0.5, 1],
          duration: 300,
          easing: "easeOutQuad",
          delay: 150,
        });

        // 3. Pequeño destello antes de la llama
        anime({
          targets: ".wick-glow",
          scale: [1, 1.5],
          opacity: [1, 0],
          duration: 100,
          easing: "easeInQuad",
          delay: 400,
        });

        // 4. Aparición de la llama
        anime({
          targets: ".flame",
          opacity: [0, 1],
          scale: [0.3, 1.3],
          duration: 200,
          easing: "easeOutBack",
          delay: 500,
          complete: function () {
            // Ajuste final de la llama
            anime({
              targets: ".flame",
              scale: [1.3, 0.9],
              duration: 100,
              easing: "easeInQuad",
              complete: function () {
                // Iniciar animaciones continuas
                animateFlame();
                createSparks();

                // Efecto de onda de luz
                anime({
                  targets: "#light-wave",
                  opacity: [0, 0.8],
                  scale: [0.1, 3],
                  duration: config.lightWaveDuration,
                  easing: "easeOutExpo",
                  complete: function () {
                    // Ocultar experiencia
                    anime({
                      targets: "#experience",
                      opacity: 0,
                      duration: 600,
                      easing: "easeInQuad",
                    });

                    // Mostrar contenido final
                    anime({
                      targets: "#final-content",
                      opacity: 1,
                      duration: 800,
                      easing: "easeOutQuad",
                    });

                    // Desvanecer onda de luz
                    anime({
                      targets: "#light-wave",
                      opacity: [0.8, 0],
                      duration: 800,
                      easing: "easeInQuad",
                    });
                  },
                });
              },
            });
          },
        });
      }

      // Animación de llama
      function animateFlame() {
        // Movimiento base
        anime({
          targets: ".flame",
          translateX: function () {
            return anime.random(-8, 8);
          },
          translateY: function () {
            return anime.random(-5, 5);
          },
          scaleX: function () {
            return anime.random(0.8, 1.2);
          },
          scaleY: function () {
            return anime.random(0.8, 1.3);
          },
          filter: function () {
            const blur = anime.random(5, 10);
            const brightness = anime.random(1.1, 1.5);
            return `blur(${blur}px) brightness(${brightness})`;
          },
          duration: function () {
            return anime.random(400, 700);
          },
          easing: "easeInOutSine",
          loop: true,
          direction: "alternate",
        });

        // Cambios de intensidad
        setInterval(function () {
          anime({
            targets: ".flame",
            scaleY: function () {
              return anime.random(0.8, 1.4);
            },
            scaleX: function () {
              return anime.random(0.9, 1.2);
            },
            duration: anime.random(500, 900),
            easing: "easeInOutSine",
          });
        }, 800);

        // Crear chispas
        setInterval(function () {
          if (Math.random() > 0.5) {
            createSparks(3 + Math.floor(Math.random() * 4));
          }
        }, 400);
      }

      // Crear chispas
      function createSparks(count = config.sparks) {
        const container = document.getElementById("experience");
        const candle = document.getElementById("candle-container");
        const candleRect = candle.getBoundingClientRect();
        const centerX = candleRect.left + candleRect.width / 2;
        const centerY = candleRect.top;

        for (let i = 0; i < count; i++) {
          const spark = document.createElement("div");
          spark.className = "spark";

          spark.style.left = `${centerX}px`;
          spark.style.top = `${centerY - 12}px`;

          const size = Math.random() * 4 + 2;
          const hue = Math.random() * 30 + 20;
          spark.style.width = `${size}px`;
          spark.style.height = `${size}px`;
          spark.style.background = `radial-gradient(circle, hsl(${hue}, 100%, 50%) 0%, transparent 70%`;

          container.appendChild(spark);

          anime({
            targets: spark,
            translateX: () => anime.random(-60, 60),
            translateY: () => anime.random(-100, -180),
            opacity: [1, 0],
            scale: [1, 0.2],
            duration: () => anime.random(500, 1000),
            easing: "easeOutExpo",
            delay: () => anime.random(0, 200),
            complete: () => spark.remove(),
          });
        }
      }
    </script>
  </body>
</html>
